/*!CK:739276807!*//*1404108716,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["b0yLs"]); }

__d("MorePagerFetchOnScroll",["AsyncRequest","DOMQuery","Event","Style","Vector","throttle"],function(a,b,c,d,e,f,g,h,i,j,k,l){function m(n,o){"use strict";this._pager=n;this._offset=o||0;this._scrollParent=j.getScrollParent(n);this.setPagerInViewHandler(this._defaultPagerInViewHandler.bind(this));if(!this.check())this._scrollListener=i.listen(this._scrollParent,'scroll',l(function(){this.check();}.bind(this),50));}m.prototype.check=function(){"use strict";if(!h.contains(document.body,this._pager)){this.removeScrollListener();return true;}var n=k.getElementPosition(this._pager).y,o=this._scrollParent===window?k.getViewportDimensions().y:k.getElementDimensions(this._scrollParent).y,p=this._scrollParent===window?k.getScrollPosition().y+o:k.getElementPosition(this._scrollParent).y+o;if(n-this._offset<p){this._inViewHandler();this.removeScrollListener();return true;}return false;};m.prototype.removeScrollListener=function(){"use strict";this._scrollListener&&this._scrollListener.remove();};m.prototype.setPagerInViewHandler=function(n){"use strict";this._inViewHandler=n;return this;};m.prototype._defaultPagerInViewHandler=function(){"use strict";var n=h.scry(this._pager,'a')[0];if(n)g.bootstrap(n.getAttribute('ajaxify')||n.href,n);};e.exports=m;},null);
__d("PluginLikebox",["AsyncDOM","AsyncRequest","CSS","DOMEvent","DOMEventListener","DOMQuery","MorePagerFetchOnScroll","copyProperties","PlatformWidgetEndpoint"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o){function p(q,r,s){this.stream_id=q;this.force_wall=r;this.width=s;this.load();k.add(l.find(document.body,'.pluginLikeboxStream'),'click',function(t){var u=new j(t),v=u.target.parentNode;if(i.hasClass(v,'text_exposed_link')){u.kill();i.addClass(l.find(v,'^.text_exposed_root'),'text_exposed');}});}n(p.prototype,{load:function(q){new h().setMethod('GET').setURI(o.plugins('likebox','stream')).setData({id:this.stream_id,dom:q?'pluginLikeboxMoreStories':'pluginLikeboxStream',force_wall:this.force_wall,nobootload:1,inlinecss:1,max_timestamp:q,width:this.width}).setReadOnly(true).setErrorHandler(function(){}).setHandler(this.handleResponse.bind(this)).send();},handleResponse:function(q){if(q.inlinecss){var r=document.createElement('style');r.setAttribute("type","text/css");document.getElementsByTagName('head')[0].appendChild(r);if(r.styleSheet){r.styleSheet.cssText=q.inlinecss;}else r.appendChild(document.createTextNode(q.inlinecss));}g.invoke(q.domops);var s=l.scry(document.body,"#pluginLikeboxMoreStories a");if(!s.length)return;s=s[0];var t=function(){this.load(parseInt(s.getAttribute('data-timestamp'),10));var v=l.find(s.parentNode,'.uiMorePagerLoader');i.addClass(v,'uiMorePagerPrimary');i.removeClass(v,'uiMorePagerLoader');i.hide(s);}.bind(this);k.add(s,'click',function(v){new j(v).kill();t();});new m(s,0).setPagerInViewHandler(t);var u=parseInt(s.getAttribute('data-storycount'),10);if(u===0)t();return h.suppressOnloadToken;}});e.exports=p;},null);
__d("TimelineAggregatePost",["AsyncRequest","DataStore","DOM","Event","Parent","ScrollableArea","Style","cx"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n){var o={init:function(p){j.listen(p,'click',function(q){var r=q.getTarget();if(q.isDefaultRequested()||r.tagName==='A'||k.byClass(r,"_1ww"))return true;var s=k.byTag(r,'li'),t=h.get(s,'url');g.bootstrap(t,s);});},initPage:function(p){j.listen(p,'click',function(q){var r=k.byClass(q.getTarget(),'uiCloseButton');if(r)return;var s=k.byTag(q.getTarget(),'li');new g().setURI(h.get(s,'url')).send();});},poke:function(p){l.poke(p);},setScrollHeight:function(p){var q=i.find(p,'.sArea');m.set(q,'height',p.offsetHeight+'px');}};e.exports=o;},null);
__d("legacy:TimelineAggregatePost",["TimelineAggregatePost"],function(a,b,c,d){a.TimelineAggregatePost=b('TimelineAggregatePost');},3);